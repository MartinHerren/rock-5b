From 3a18e0093866618e66d606714dad78d4627e34fc Mon Sep 17 00:00:00 2001
From: John Clark <inindev@gmail.com>
Date: Sat, 24 Jun 2023 16:31:12 +0000
Subject: [PATCH 27/29] add sfc partition table

Signed-off-by: John Clark <inindev@gmail.com>
---
 arch/arm/dts/rk3588-rock-5b-u-boot.dtsi | 27 +++++++++++++++++++++++++
 configs/rock5b-rk3588_defconfig         |  2 +-
 2 files changed, 28 insertions(+), 1 deletion(-)

diff --git a/arch/arm/dts/rk3588-rock-5b-u-boot.dtsi b/arch/arm/dts/rk3588-rock-5b-u-boot.dtsi
index 6cdea11f84..27e4d6a357 100644
--- a/arch/arm/dts/rk3588-rock-5b-u-boot.dtsi
+++ b/arch/arm/dts/rk3588-rock-5b-u-boot.dtsi
@@ -196,6 +196,33 @@
 		spi-max-frequency = <24000000>;
 		spi-rx-bus-width = <4>;
 		spi-tx-bus-width = <1>;
+
+		partitions {
+			compatible = "fixed-partitions";
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			partition@0 {
+				label = "u-boot-spl";
+				reg = <0x0 0xe0000>;
+			};
+			partition@e0000 {
+				label = "u-boot-env";
+				reg = <0xe0000 0x20000>;
+			};
+			partition@100000 {
+				label = "u-boot";
+				reg = <0x100000 0x200000>;
+			};
+			partition@300000 {
+				label = "splash";
+				reg = <0x300000 0x100000>;
+			};
+			partition@400000 {
+				label = "filesystem";
+				reg = <0x400000 0xc00000>;
+			};
+		};
 	};
 };
 
diff --git a/configs/rock5b-rk3588_defconfig b/configs/rock5b-rk3588_defconfig
index 3f28a68f0c..7717b2e423 100644
--- a/configs/rock5b-rk3588_defconfig
+++ b/configs/rock5b-rk3588_defconfig
@@ -43,7 +43,7 @@ CONFIG_SPL_BSS_MAX_SIZE=0x4000
 # CONFIG_SPL_SHARES_INIT_SP_ADDR is not set
 CONFIG_SPL_STACK_R=y
 CONFIG_SPL_SPI_LOAD=y
-CONFIG_SYS_SPI_U_BOOT_OFFS=0x60000
+CONFIG_SYS_SPI_U_BOOT_OFFS=0x100000
 CONFIG_SPL_ATF=y
 CONFIG_CMD_GPIO=y
 CONFIG_CMD_GPT=y
-- 
2.39.2

